#include "StdAfx.h"
#include "CAASymCipher.hpp"

CAASymCipher::CAASymCipher()
	{
		rsa=RSA_new();
		BN_dec2bn(&rsa->n,"146045156752988119086694783791784827226235382817403930968569889520448117142515762490154404168568789906602128114569640745056455078919081535135223786488790643345745133490238858425068609186364886282528002310113020992003131292706048279603244985126945363695371250073851319256901415103802627246986865697725280735339");
		BN_dec2bn(&rsa->e,"65537");
		BN_dec2bn(&rsa->d,"100449081981135731814880969134969450418081177287292668146836998032008168337214710926746722039495350318598616459287747779485859425017265350531079350592317712851494980594232914153427023840292323686802553784291416771584974703478561388467839475898474798517021187817368293846108514686245237357922210697818039852961");
	}

CAASymCipher::~CAASymCipher()
	{
		RSA_free(rsa);
	}

int CAASymCipher::decrypt(unsigned char* from,unsigned char* to)
	{
		return RSA_private_decrypt(128,from,to,rsa,RSA_NO_PADDING);		
	}

int CAASymCipher::encrypt(unsigned char* from,unsigned char* to)
	{
		return RSA_public_encrypt(128,from,to,rsa,RSA_NO_PADDING);		
	}
